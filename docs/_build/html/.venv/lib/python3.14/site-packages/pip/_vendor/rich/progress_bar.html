

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Number of characters before ‘pulse’ animation repeats &mdash; Retrogue 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/custom.css?v=a6a68382" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/fonts.css?v=5583d106" />

  
      <script src="../../../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../../index.html" class="icon icon-home">
            Retrogue
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../index.html">Retrogue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Number of characters before ‘pulse’ animation repeats</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../../_sources/.venv/lib/python3.14/site-packages/pip/_vendor/rich/progress_bar.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>import math
from functools import lru_cache
from time import monotonic
from typing import Iterable, List, Optional</p>
<p>from .color import Color, blend_rgb
from .color_triplet import ColorTriplet
from .console import Console, ConsoleOptions, RenderResult
from .jupyter import JupyterMixin
from .measure import Measurement
from .segment import Segment
from .style import Style, StyleType</p>
<section id="number-of-characters-before-pulse-animation-repeats">
<h1>Number of characters before ‘pulse’ animation repeats<a class="headerlink" href="#number-of-characters-before-pulse-animation-repeats" title="Link to this heading"></a></h1>
<p>PULSE_SIZE = 20</p>
<p>class ProgressBar(JupyterMixin):
“””Renders a (progress) bar. Used by rich.progress.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Args:
    total (float, optional): Number of steps in the bar. Defaults to 100. Set to None to render a pulsing animation.
    completed (float, optional): Number of steps completed. Defaults to 0.
    width (int, optional): Width of the bar, or ``None`` for maximum width. Defaults to None.
    pulse (bool, optional): Enable pulse effect. Defaults to False. Will pulse if a None total was passed.
    style (StyleType, optional): Style for the bar background. Defaults to &quot;bar.back&quot;.
    complete_style (StyleType, optional): Style for the completed bar. Defaults to &quot;bar.complete&quot;.
    finished_style (StyleType, optional): Style for a finished bar. Defaults to &quot;bar.finished&quot;.
    pulse_style (StyleType, optional): Style for pulsing bars. Defaults to &quot;bar.pulse&quot;.
    animation_time (Optional[float], optional): Time in seconds to use for animation, or None to use system time.
&quot;&quot;&quot;

def __init__(
    self,
    total: Optional[float] = 100.0,
    completed: float = 0,
    width: Optional[int] = None,
    pulse: bool = False,
    style: StyleType = &quot;bar.back&quot;,
    complete_style: StyleType = &quot;bar.complete&quot;,
    finished_style: StyleType = &quot;bar.finished&quot;,
    pulse_style: StyleType = &quot;bar.pulse&quot;,
    animation_time: Optional[float] = None,
):
    self.total = total
    self.completed = completed
    self.width = width
    self.pulse = pulse
    self.style = style
    self.complete_style = complete_style
    self.finished_style = finished_style
    self.pulse_style = pulse_style
    self.animation_time = animation_time

    self._pulse_segments: Optional[List[Segment]] = None

def __repr__(self) -&gt; str:
    return f&quot;&lt;Bar {self.completed!r} of {self.total!r}&gt;&quot;

@property
def percentage_completed(self) -&gt; Optional[float]:
    &quot;&quot;&quot;Calculate percentage complete.&quot;&quot;&quot;
    if self.total is None:
        return None
    completed = (self.completed / self.total) * 100.0
    completed = min(100, max(0.0, completed))
    return completed

@lru_cache(maxsize=16)
def _get_pulse_segments(
    self,
    fore_style: Style,
    back_style: Style,
    color_system: str,
    no_color: bool,
    ascii: bool = False,
) -&gt; List[Segment]:
    &quot;&quot;&quot;Get a list of segments to render a pulse animation.

    Returns:
        List[Segment]: A list of segments, one segment per character.
    &quot;&quot;&quot;
    bar = &quot;-&quot; if ascii else &quot;━&quot;
    segments: List[Segment] = []
    if color_system not in (&quot;standard&quot;, &quot;eight_bit&quot;, &quot;truecolor&quot;) or no_color:
        segments += [Segment(bar, fore_style)] * (PULSE_SIZE // 2)
        segments += [Segment(&quot; &quot; if no_color else bar, back_style)] * (
            PULSE_SIZE - (PULSE_SIZE // 2)
        )
        return segments

    append = segments.append
    fore_color = (
        fore_style.color.get_truecolor()
        if fore_style.color
        else ColorTriplet(255, 0, 255)
    )
    back_color = (
        back_style.color.get_truecolor()
        if back_style.color
        else ColorTriplet(0, 0, 0)
    )
    cos = math.cos
    pi = math.pi
    _Segment = Segment
    _Style = Style
    from_triplet = Color.from_triplet

    for index in range(PULSE_SIZE):
        position = index / PULSE_SIZE
        fade = 0.5 + cos(position * pi * 2) / 2.0
        color = blend_rgb(fore_color, back_color, cross_fade=fade)
        append(_Segment(bar, _Style(color=from_triplet(color))))
    return segments

def update(self, completed: float, total: Optional[float] = None) -&gt; None:
    &quot;&quot;&quot;Update progress with new values.

    Args:
        completed (float): Number of steps completed.
        total (float, optional): Total number of steps, or ``None`` to not change. Defaults to None.
    &quot;&quot;&quot;
    self.completed = completed
    self.total = total if total is not None else self.total

def _render_pulse(
    self, console: Console, width: int, ascii: bool = False
) -&gt; Iterable[Segment]:
    &quot;&quot;&quot;Renders the pulse animation.

    Args:
        console (Console): Console instance.
        width (int): Width in characters of pulse animation.

    Returns:
        RenderResult: [description]

    Yields:
        Iterator[Segment]: Segments to render pulse
    &quot;&quot;&quot;
    fore_style = console.get_style(self.pulse_style, default=&quot;white&quot;)
    back_style = console.get_style(self.style, default=&quot;black&quot;)

    pulse_segments = self._get_pulse_segments(
        fore_style, back_style, console.color_system, console.no_color, ascii=ascii
    )
    segment_count = len(pulse_segments)
    current_time = (
        monotonic() if self.animation_time is None else self.animation_time
    )
    segments = pulse_segments * (int(width / segment_count) + 2)
    offset = int(-current_time * 15) % segment_count
    segments = segments[offset : offset + width]
    yield from segments

def __rich_console__(
    self, console: Console, options: ConsoleOptions
) -&gt; RenderResult:
    width = min(self.width or options.max_width, options.max_width)
    ascii = options.legacy_windows or options.ascii_only
    should_pulse = self.pulse or self.total is None
    if should_pulse:
        yield from self._render_pulse(console, width, ascii=ascii)
        return

    completed: Optional[float] = (
        min(self.total, max(0, self.completed)) if self.total is not None else None
    )

    bar = &quot;-&quot; if ascii else &quot;━&quot;
    half_bar_right = &quot; &quot; if ascii else &quot;╸&quot;
    half_bar_left = &quot; &quot; if ascii else &quot;╺&quot;
    complete_halves = (
        int(width * 2 * completed / self.total)
        if self.total and completed is not None
        else width * 2
    )
    bar_count = complete_halves // 2
    half_bar_count = complete_halves % 2
    style = console.get_style(self.style)
    is_finished = self.total is None or self.completed &gt;= self.total
    complete_style = console.get_style(
        self.finished_style if is_finished else self.complete_style
    )
    _Segment = Segment
    if bar_count:
        yield _Segment(bar * bar_count, complete_style)
    if half_bar_count:
        yield _Segment(half_bar_right * half_bar_count, complete_style)

    if not console.no_color:
        remaining_bars = width - bar_count - half_bar_count
        if remaining_bars and console.color_system is not None:
            if not half_bar_count and bar_count:
                yield _Segment(half_bar_left, style)
                remaining_bars -= 1
            if remaining_bars:
                yield _Segment(bar * remaining_bars, style)

def __rich_measure__(
    self, console: Console, options: ConsoleOptions
) -&gt; Measurement:
    return (
        Measurement(self.width, self.width)
        if self.width is not None
        else Measurement(4, options.max_width)
    )
</pre></div>
</div>
<p>if <strong>name</strong> == “<strong>main</strong>”:  # pragma: no cover
console = Console()
bar = ProgressBar(width=50, total=100)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import time

console.show_cursor(False)
for n in range(0, 101, 1):
    bar.update(n)
    console.print(bar)
    console.file.write(&quot;\r&quot;)
    time.sleep(0.05)
console.show_cursor(True)
console.print()
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Adam Worsnip.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>