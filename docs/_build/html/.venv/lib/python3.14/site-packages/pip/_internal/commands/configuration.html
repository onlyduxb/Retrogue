

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Retrogue 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/custom.css?v=a6a68382" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/fonts.css?v=5583d106" />

  
      <script src="../../../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../../index.html" class="icon icon-home">
            Retrogue
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../index.html">Retrogue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../../_sources/.venv/lib/python3.14/site-packages/pip/_internal/commands/configuration.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>from <strong>future</strong> import annotations</p>
<p>import logging
import os
import subprocess
from optparse import Values
from typing import Any, Callable</p>
<p>from pip._internal.cli.base_command import Command
from pip._internal.cli.status_codes import ERROR, SUCCESS
from pip._internal.configuration import (
Configuration,
Kind,
get_configuration_files,
kinds,
)
from pip._internal.exceptions import PipError
from pip._internal.utils.logging import indent_log
from pip._internal.utils.misc import get_prog, write_output</p>
<p>logger = logging.getLogger(<strong>name</strong>)</p>
<p>class ConfigurationCommand(Command):
“””
Manage local and global configuration.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Subcommands:

- list: List the active configuration (or from the file specified)
- edit: Edit the configuration file in an editor
- get: Get the value associated with command.option
- set: Set the command.option=value
- unset: Unset the value associated with command.option
- debug: List the configuration files and values defined under them

Configuration keys should be dot separated command and option name,
with the special prefix &quot;global&quot; affecting any command. For example,
&quot;pip config set global.index-url https://example.org/&quot; would configure
the index url for all commands, but &quot;pip config set download.timeout 10&quot;
would configure a 10 second timeout only for &quot;pip download&quot; commands.

If none of --user, --global and --site are passed, a virtual
environment configuration file is used if one is active and the file
exists. Otherwise, all modifications happen to the user file by
default.
&quot;&quot;&quot;

ignore_require_venv = True
usage = &quot;&quot;&quot;
    %prog [&lt;file-option&gt;] list
    %prog [&lt;file-option&gt;] [--editor &lt;editor-path&gt;] edit

    %prog [&lt;file-option&gt;] get command.option
    %prog [&lt;file-option&gt;] set command.option value
    %prog [&lt;file-option&gt;] unset command.option
    %prog [&lt;file-option&gt;] debug
&quot;&quot;&quot;

def add_options(self) -&gt; None:
    self.cmd_opts.add_option(
        &quot;--editor&quot;,
        dest=&quot;editor&quot;,
        action=&quot;store&quot;,
        default=None,
        help=(
            &quot;Editor to use to edit the file. Uses VISUAL or EDITOR &quot;
            &quot;environment variables if not provided.&quot;
        ),
    )

    self.cmd_opts.add_option(
        &quot;--global&quot;,
        dest=&quot;global_file&quot;,
        action=&quot;store_true&quot;,
        default=False,
        help=&quot;Use the system-wide configuration file only&quot;,
    )

    self.cmd_opts.add_option(
        &quot;--user&quot;,
        dest=&quot;user_file&quot;,
        action=&quot;store_true&quot;,
        default=False,
        help=&quot;Use the user configuration file only&quot;,
    )

    self.cmd_opts.add_option(
        &quot;--site&quot;,
        dest=&quot;site_file&quot;,
        action=&quot;store_true&quot;,
        default=False,
        help=&quot;Use the current environment configuration file only&quot;,
    )

    self.parser.insert_option_group(0, self.cmd_opts)

def handler_map(self) -&gt; dict[str, Callable[[Values, list[str]], None]]:
    return {
        &quot;list&quot;: self.list_values,
        &quot;edit&quot;: self.open_in_editor,
        &quot;get&quot;: self.get_name,
        &quot;set&quot;: self.set_name_value,
        &quot;unset&quot;: self.unset_name,
        &quot;debug&quot;: self.list_config_values,
    }

def run(self, options: Values, args: list[str]) -&gt; int:
    handler_map = self.handler_map()

    # Determine action
    if not args or args[0] not in handler_map:
        logger.error(
            &quot;Need an action (%s) to perform.&quot;,
            &quot;, &quot;.join(sorted(handler_map)),
        )
        return ERROR

    action = args[0]

    # Determine which configuration files are to be loaded
    #    Depends on whether the command is modifying.
    try:
        load_only = self._determine_file(
            options, need_value=(action in [&quot;get&quot;, &quot;set&quot;, &quot;unset&quot;, &quot;edit&quot;])
        )
    except PipError as e:
        logger.error(e.args[0])
        return ERROR

    # Load a new configuration
    self.configuration = Configuration(
        isolated=options.isolated_mode, load_only=load_only
    )
    self.configuration.load()

    # Error handling happens here, not in the action-handlers.
    try:
        handler_map[action](options, args[1:])
    except PipError as e:
        logger.error(e.args[0])
        return ERROR

    return SUCCESS

def _determine_file(self, options: Values, need_value: bool) -&gt; Kind | None:
    file_options = [
        key
        for key, value in (
            (kinds.USER, options.user_file),
            (kinds.GLOBAL, options.global_file),
            (kinds.SITE, options.site_file),
        )
        if value
    ]

    if not file_options:
        if not need_value:
            return None
        # Default to user, unless there&#39;s a site file.
        elif any(
            os.path.exists(site_config_file)
            for site_config_file in get_configuration_files()[kinds.SITE]
        ):
            return kinds.SITE
        else:
            return kinds.USER
    elif len(file_options) == 1:
        return file_options[0]

    raise PipError(
        &quot;Need exactly one file to operate upon &quot;
        &quot;(--user, --site, --global) to perform.&quot;
    )

def list_values(self, options: Values, args: list[str]) -&gt; None:
    self._get_n_args(args, &quot;list&quot;, n=0)

    for key, value in sorted(self.configuration.items()):
        for key, value in sorted(value.items()):
            write_output(&quot;%s=%r&quot;, key, value)

def get_name(self, options: Values, args: list[str]) -&gt; None:
    key = self._get_n_args(args, &quot;get [name]&quot;, n=1)
    value = self.configuration.get_value(key)

    write_output(&quot;%s&quot;, value)

def set_name_value(self, options: Values, args: list[str]) -&gt; None:
    key, value = self._get_n_args(args, &quot;set [name] [value]&quot;, n=2)
    self.configuration.set_value(key, value)

    self._save_configuration()

def unset_name(self, options: Values, args: list[str]) -&gt; None:
    key = self._get_n_args(args, &quot;unset [name]&quot;, n=1)
    self.configuration.unset_value(key)

    self._save_configuration()

def list_config_values(self, options: Values, args: list[str]) -&gt; None:
    &quot;&quot;&quot;List config key-value pairs across different config files&quot;&quot;&quot;
    self._get_n_args(args, &quot;debug&quot;, n=0)

    self.print_env_var_values()
    # Iterate over config files and print if they exist, and the
    # key-value pairs present in them if they do
    for variant, files in sorted(self.configuration.iter_config_files()):
        write_output(&quot;%s:&quot;, variant)
        for fname in files:
            with indent_log():
                file_exists = os.path.exists(fname)
                write_output(&quot;%s, exists: %r&quot;, fname, file_exists)
                if file_exists:
                    self.print_config_file_values(variant, fname)

def print_config_file_values(self, variant: Kind, fname: str) -&gt; None:
    &quot;&quot;&quot;Get key-value pairs from the file of a variant&quot;&quot;&quot;
    for name, value in self.configuration.get_values_in_config(variant).items():
        with indent_log():
            if name == fname:
                for confname, confvalue in value.items():
                    write_output(&quot;%s: %s&quot;, confname, confvalue)

def print_env_var_values(self) -&gt; None:
    &quot;&quot;&quot;Get key-values pairs present as environment variables&quot;&quot;&quot;
    write_output(&quot;%s:&quot;, &quot;env_var&quot;)
    with indent_log():
        for key, value in sorted(self.configuration.get_environ_vars()):
            env_var = f&quot;PIP_{key.upper()}&quot;
            write_output(&quot;%s=%r&quot;, env_var, value)

def open_in_editor(self, options: Values, args: list[str]) -&gt; None:
    editor = self._determine_editor(options)

    fname = self.configuration.get_file_to_edit()
    if fname is None:
        raise PipError(&quot;Could not determine appropriate file.&quot;)
    elif &#39;&quot;&#39; in fname:
        # This shouldn&#39;t happen, unless we see a username like that.
        # If that happens, we&#39;d appreciate a pull request fixing this.
        raise PipError(
            f&#39;Can not open an editor for a file name containing &quot;\n{fname}&#39;
        )

    try:
        subprocess.check_call(f&#39;{editor} &quot;{fname}&quot;&#39;, shell=True)
    except FileNotFoundError as e:
        if not e.filename:
            e.filename = editor
        raise
    except subprocess.CalledProcessError as e:
        raise PipError(f&quot;Editor Subprocess exited with exit code {e.returncode}&quot;)

def _get_n_args(self, args: list[str], example: str, n: int) -&gt; Any:
    &quot;&quot;&quot;Helper to make sure the command got the right number of arguments&quot;&quot;&quot;
    if len(args) != n:
        msg = (
            f&quot;Got unexpected number of arguments, expected {n}. &quot;
            f&#39;(example: &quot;{get_prog()} config {example}&quot;)&#39;
        )
        raise PipError(msg)

    if n == 1:
        return args[0]
    else:
        return args

def _save_configuration(self) -&gt; None:
    # We successfully ran a modifying command. Need to save the
    # configuration.
    try:
        self.configuration.save()
    except Exception:
        logger.exception(
            &quot;Unable to save configuration. Please report this as a bug.&quot;
        )
        raise PipError(&quot;Internal Error.&quot;)

def _determine_editor(self, options: Values) -&gt; str:
    if options.editor is not None:
        return options.editor
    elif &quot;VISUAL&quot; in os.environ:
        return os.environ[&quot;VISUAL&quot;]
    elif &quot;EDITOR&quot; in os.environ:
        return os.environ[&quot;EDITOR&quot;]
    else:
        raise PipError(&quot;Could not determine editor to use.&quot;)
</pre></div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Adam Worsnip.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>