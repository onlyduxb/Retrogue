

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Retrogue 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/custom.css?v=a6a68382" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/fonts.css?v=5583d106" />

  
      <script src="../../../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../../index.html" class="icon icon-home">
            Retrogue
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../index.html">Retrogue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../../_sources/.venv/lib/python3.14/site-packages/pip/_vendor/rich/layout.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>from abc import ABC, abstractmethod
from itertools import islice
from operator import itemgetter
from threading import RLock
from typing import (
TYPE_CHECKING,
Dict,
Iterable,
List,
NamedTuple,
Optional,
Sequence,
Tuple,
Union,
)</p>
<p>from ._ratio import ratio_resolve
from .align import Align
from .console import Console, ConsoleOptions, RenderableType, RenderResult
from .highlighter import ReprHighlighter
from .panel import Panel
from .pretty import Pretty
from .region import Region
from .repr import Result, rich_repr
from .segment import Segment
from .style import StyleType</p>
<p>if TYPE_CHECKING:
from pip._vendor.rich.tree import Tree</p>
<p>class LayoutRender(NamedTuple):
“””An individual layout render.”””</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>region: Region
render: List[List[Segment]]
</pre></div>
</div>
<p>RegionMap = Dict[“Layout”, Region]
RenderMap = Dict[“Layout”, LayoutRender]</p>
<p>class LayoutError(Exception):
“””Layout related error.”””</p>
<p>class NoSplitter(LayoutError):
“””Requested splitter does not exist.”””</p>
<p>class _Placeholder:
“””An internal renderable used as a Layout placeholder.”””</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>highlighter = ReprHighlighter()

def __init__(self, layout: &quot;Layout&quot;, style: StyleType = &quot;&quot;) -&gt; None:
    self.layout = layout
    self.style = style

def __rich_console__(
    self, console: Console, options: ConsoleOptions
) -&gt; RenderResult:
    width = options.max_width
    height = options.height or options.size.height
    layout = self.layout
    title = (
        f&quot;{layout.name!r} ({width} x {height})&quot;
        if layout.name
        else f&quot;({width} x {height})&quot;
    )
    yield Panel(
        Align.center(Pretty(layout), vertical=&quot;middle&quot;),
        style=self.style,
        title=self.highlighter(title),
        border_style=&quot;blue&quot;,
        height=height,
    )
</pre></div>
</div>
<p>class Splitter(ABC):
“””Base class for a splitter.”””</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>name: str = &quot;&quot;

@abstractmethod
def get_tree_icon(self) -&gt; str:
    &quot;&quot;&quot;Get the icon (emoji) used in layout.tree&quot;&quot;&quot;

@abstractmethod
def divide(
    self, children: Sequence[&quot;Layout&quot;], region: Region
) -&gt; Iterable[Tuple[&quot;Layout&quot;, Region]]:
    &quot;&quot;&quot;Divide a region amongst several child layouts.

    Args:
        children (Sequence(Layout)): A number of child layouts.
        region (Region): A rectangular region to divide.
    &quot;&quot;&quot;
</pre></div>
</div>
<p>class RowSplitter(Splitter):
“””Split a layout region in to rows.”””</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>name = &quot;row&quot;

def get_tree_icon(self) -&gt; str:
    return &quot;[layout.tree.row]⬌&quot;

def divide(
    self, children: Sequence[&quot;Layout&quot;], region: Region
) -&gt; Iterable[Tuple[&quot;Layout&quot;, Region]]:
    x, y, width, height = region
    render_widths = ratio_resolve(width, children)
    offset = 0
    _Region = Region
    for child, child_width in zip(children, render_widths):
        yield child, _Region(x + offset, y, child_width, height)
        offset += child_width
</pre></div>
</div>
<p>class ColumnSplitter(Splitter):
“””Split a layout region in to columns.”””</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>name = &quot;column&quot;

def get_tree_icon(self) -&gt; str:
    return &quot;[layout.tree.column]⬍&quot;

def divide(
    self, children: Sequence[&quot;Layout&quot;], region: Region
) -&gt; Iterable[Tuple[&quot;Layout&quot;, Region]]:
    x, y, width, height = region
    render_heights = ratio_resolve(height, children)
    offset = 0
    _Region = Region
    for child, child_height in zip(children, render_heights):
        yield child, _Region(x, y + offset, width, child_height)
        offset += child_height
</pre></div>
</div>
<p>&#64;rich_repr
class Layout:
“””A renderable to divide a fixed height in to rows or columns.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Args:
    renderable (RenderableType, optional): Renderable content, or None for placeholder. Defaults to None.
    name (str, optional): Optional identifier for Layout. Defaults to None.
    size (int, optional): Optional fixed size of layout. Defaults to None.
    minimum_size (int, optional): Minimum size of layout. Defaults to 1.
    ratio (int, optional): Optional ratio for flexible layout. Defaults to 1.
    visible (bool, optional): Visibility of layout. Defaults to True.
&quot;&quot;&quot;

splitters = {&quot;row&quot;: RowSplitter, &quot;column&quot;: ColumnSplitter}

def __init__(
    self,
    renderable: Optional[RenderableType] = None,
    *,
    name: Optional[str] = None,
    size: Optional[int] = None,
    minimum_size: int = 1,
    ratio: int = 1,
    visible: bool = True,
) -&gt; None:
    self._renderable = renderable or _Placeholder(self)
    self.size = size
    self.minimum_size = minimum_size
    self.ratio = ratio
    self.name = name
    self.visible = visible
    self.splitter: Splitter = self.splitters[&quot;column&quot;]()
    self._children: List[Layout] = []
    self._render_map: RenderMap = {}
    self._lock = RLock()

def __rich_repr__(self) -&gt; Result:
    yield &quot;name&quot;, self.name, None
    yield &quot;size&quot;, self.size, None
    yield &quot;minimum_size&quot;, self.minimum_size, 1
    yield &quot;ratio&quot;, self.ratio, 1

@property
def renderable(self) -&gt; RenderableType:
    &quot;&quot;&quot;Layout renderable.&quot;&quot;&quot;
    return self if self._children else self._renderable

@property
def children(self) -&gt; List[&quot;Layout&quot;]:
    &quot;&quot;&quot;Gets (visible) layout children.&quot;&quot;&quot;
    return [child for child in self._children if child.visible]

@property
def map(self) -&gt; RenderMap:
    &quot;&quot;&quot;Get a map of the last render.&quot;&quot;&quot;
    return self._render_map

def get(self, name: str) -&gt; Optional[&quot;Layout&quot;]:
    &quot;&quot;&quot;Get a named layout, or None if it doesn&#39;t exist.

    Args:
        name (str): Name of layout.

    Returns:
        Optional[Layout]: Layout instance or None if no layout was found.
    &quot;&quot;&quot;
    if self.name == name:
        return self
    else:
        for child in self._children:
            named_layout = child.get(name)
            if named_layout is not None:
                return named_layout
    return None

def __getitem__(self, name: str) -&gt; &quot;Layout&quot;:
    layout = self.get(name)
    if layout is None:
        raise KeyError(f&quot;No layout with name {name!r}&quot;)
    return layout

@property
def tree(self) -&gt; &quot;Tree&quot;:
    &quot;&quot;&quot;Get a tree renderable to show layout structure.&quot;&quot;&quot;
    from pip._vendor.rich.styled import Styled
    from pip._vendor.rich.table import Table
    from pip._vendor.rich.tree import Tree

    def summary(layout: &quot;Layout&quot;) -&gt; Table:
        icon = layout.splitter.get_tree_icon()

        table = Table.grid(padding=(0, 1, 0, 0))

        text: RenderableType = (
            Pretty(layout) if layout.visible else Styled(Pretty(layout), &quot;dim&quot;)
        )
        table.add_row(icon, text)
        _summary = table
        return _summary

    layout = self
    tree = Tree(
        summary(layout),
        guide_style=f&quot;layout.tree.{layout.splitter.name}&quot;,
        highlight=True,
    )

    def recurse(tree: &quot;Tree&quot;, layout: &quot;Layout&quot;) -&gt; None:
        for child in layout._children:
            recurse(
                tree.add(
                    summary(child),
                    guide_style=f&quot;layout.tree.{child.splitter.name}&quot;,
                ),
                child,
            )

    recurse(tree, self)
    return tree

def split(
    self,
    *layouts: Union[&quot;Layout&quot;, RenderableType],
    splitter: Union[Splitter, str] = &quot;column&quot;,
) -&gt; None:
    &quot;&quot;&quot;Split the layout in to multiple sub-layouts.

    Args:
        *layouts (Layout): Positional arguments should be (sub) Layout instances.
        splitter (Union[Splitter, str]): Splitter instance or name of splitter.
    &quot;&quot;&quot;
    _layouts = [
        layout if isinstance(layout, Layout) else Layout(layout)
        for layout in layouts
    ]
    try:
        self.splitter = (
            splitter
            if isinstance(splitter, Splitter)
            else self.splitters[splitter]()
        )
    except KeyError:
        raise NoSplitter(f&quot;No splitter called {splitter!r}&quot;)
    self._children[:] = _layouts

def add_split(self, *layouts: Union[&quot;Layout&quot;, RenderableType]) -&gt; None:
    &quot;&quot;&quot;Add a new layout(s) to existing split.

    Args:
        *layouts (Union[Layout, RenderableType]): Positional arguments should be renderables or (sub) Layout instances.

    &quot;&quot;&quot;
    _layouts = (
        layout if isinstance(layout, Layout) else Layout(layout)
        for layout in layouts
    )
    self._children.extend(_layouts)

def split_row(self, *layouts: Union[&quot;Layout&quot;, RenderableType]) -&gt; None:
    &quot;&quot;&quot;Split the layout in to a row (layouts side by side).

    Args:
        *layouts (Layout): Positional arguments should be (sub) Layout instances.
    &quot;&quot;&quot;
    self.split(*layouts, splitter=&quot;row&quot;)

def split_column(self, *layouts: Union[&quot;Layout&quot;, RenderableType]) -&gt; None:
    &quot;&quot;&quot;Split the layout in to a column (layouts stacked on top of each other).

    Args:
        *layouts (Layout): Positional arguments should be (sub) Layout instances.
    &quot;&quot;&quot;
    self.split(*layouts, splitter=&quot;column&quot;)

def unsplit(self) -&gt; None:
    &quot;&quot;&quot;Reset splits to initial state.&quot;&quot;&quot;
    del self._children[:]

def update(self, renderable: RenderableType) -&gt; None:
    &quot;&quot;&quot;Update renderable.

    Args:
        renderable (RenderableType): New renderable object.
    &quot;&quot;&quot;
    with self._lock:
        self._renderable = renderable

def refresh_screen(self, console: &quot;Console&quot;, layout_name: str) -&gt; None:
    &quot;&quot;&quot;Refresh a sub-layout.

    Args:
        console (Console): Console instance where Layout is to be rendered.
        layout_name (str): Name of layout.
    &quot;&quot;&quot;
    with self._lock:
        layout = self[layout_name]
        region, _lines = self._render_map[layout]
        (x, y, width, height) = region
        lines = console.render_lines(
            layout, console.options.update_dimensions(width, height)
        )
        self._render_map[layout] = LayoutRender(region, lines)
        console.update_screen_lines(lines, x, y)

def _make_region_map(self, width: int, height: int) -&gt; RegionMap:
    &quot;&quot;&quot;Create a dict that maps layout on to Region.&quot;&quot;&quot;
    stack: List[Tuple[Layout, Region]] = [(self, Region(0, 0, width, height))]
    push = stack.append
    pop = stack.pop
    layout_regions: List[Tuple[Layout, Region]] = []
    append_layout_region = layout_regions.append
    while stack:
        append_layout_region(pop())
        layout, region = layout_regions[-1]
        children = layout.children
        if children:
            for child_and_region in layout.splitter.divide(children, region):
                push(child_and_region)

    region_map = {
        layout: region
        for layout, region in sorted(layout_regions, key=itemgetter(1))
    }
    return region_map

def render(self, console: Console, options: ConsoleOptions) -&gt; RenderMap:
    &quot;&quot;&quot;Render the sub_layouts.

    Args:
        console (Console): Console instance.
        options (ConsoleOptions): Console options.

    Returns:
        RenderMap: A dict that maps Layout on to a tuple of Region, lines
    &quot;&quot;&quot;
    render_width = options.max_width
    render_height = options.height or console.height
    region_map = self._make_region_map(render_width, render_height)
    layout_regions = [
        (layout, region)
        for layout, region in region_map.items()
        if not layout.children
    ]
    render_map: Dict[&quot;Layout&quot;, &quot;LayoutRender&quot;] = {}
    render_lines = console.render_lines
    update_dimensions = options.update_dimensions

    for layout, region in layout_regions:
        lines = render_lines(
            layout.renderable, update_dimensions(region.width, region.height)
        )
        render_map[layout] = LayoutRender(region, lines)
    return render_map

def __rich_console__(
    self, console: Console, options: ConsoleOptions
) -&gt; RenderResult:
    with self._lock:
        width = options.max_width or console.width
        height = options.height or console.height
        render_map = self.render(console, options.update_dimensions(width, height))
        self._render_map = render_map
        layout_lines: List[List[Segment]] = [[] for _ in range(height)]
        _islice = islice
        for region, lines in render_map.values():
            _x, y, _layout_width, layout_height = region
            for row, line in zip(
                _islice(layout_lines, y, y + layout_height), lines
            ):
                row.extend(line)

        new_line = Segment.line()
        for layout_row in layout_lines:
            yield from layout_row
            yield new_line
</pre></div>
</div>
<p>if <strong>name</strong> == “<strong>main</strong>”:
from pip._vendor.rich.console import Console</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>console = Console()
layout = Layout()

layout.split_column(
    Layout(name=&quot;header&quot;, size=3),
    Layout(ratio=1, name=&quot;main&quot;),
    Layout(size=10, name=&quot;footer&quot;),
)

layout[&quot;main&quot;].split_row(Layout(name=&quot;side&quot;), Layout(name=&quot;body&quot;, ratio=2))

layout[&quot;body&quot;].split_row(Layout(name=&quot;content&quot;, ratio=2), Layout(name=&quot;s2&quot;))

layout[&quot;s2&quot;].split_column(
    Layout(name=&quot;top&quot;), Layout(name=&quot;middle&quot;), Layout(name=&quot;bottom&quot;)
)

layout[&quot;side&quot;].split_column(Layout(layout.tree, name=&quot;left1&quot;), Layout(name=&quot;left2&quot;))

layout[&quot;content&quot;].update(&quot;foo&quot;)

console.print(layout)
</pre></div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Adam Worsnip.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>