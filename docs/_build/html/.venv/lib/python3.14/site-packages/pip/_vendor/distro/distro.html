

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Copyright 2015-2021 Nir Cohen &mdash; Retrogue 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/custom.css?v=a6a68382" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/fonts.css?v=5583d106" />

  
      <script src="../../../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../../index.html" class="icon icon-home">
            Retrogue
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../index.html">Retrogue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Copyright 2015-2021 Nir Cohen</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../../_sources/.venv/lib/python3.14/site-packages/pip/_vendor/distro/distro.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>#!/usr/bin/env python</p>
<section id="copyright-2015-2021-nir-cohen">
<h1>Copyright 2015-2021 Nir Cohen<a class="headerlink" href="#copyright-2015-2021-nir-cohen" title="Link to this heading"></a></h1>
</section>
<section id="id1">
<h1><a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
</section>
<section id="licensed-under-the-apache-license-version-2-0-the-license">
<h1>Licensed under the Apache License, Version 2.0 (the “License”);<a class="headerlink" href="#licensed-under-the-apache-license-version-2-0-the-license" title="Link to this heading"></a></h1>
</section>
<section id="you-may-not-use-this-file-except-in-compliance-with-the-license">
<h1>you may not use this file except in compliance with the License.<a class="headerlink" href="#you-may-not-use-this-file-except-in-compliance-with-the-license" title="Link to this heading"></a></h1>
</section>
<section id="you-may-obtain-a-copy-of-the-license-at">
<h1>You may obtain a copy of the License at<a class="headerlink" href="#you-may-obtain-a-copy-of-the-license-at" title="Link to this heading"></a></h1>
</section>
<section id="id2">
<h1><a class="headerlink" href="#id2" title="Link to this heading"></a></h1>
</section>
<section id="http-www-apache-org-licenses-license-2-0">
<h1>http://www.apache.org/licenses/LICENSE-2.0<a class="headerlink" href="#http-www-apache-org-licenses-license-2-0" title="Link to this heading"></a></h1>
</section>
<section id="id3">
<h1><a class="headerlink" href="#id3" title="Link to this heading"></a></h1>
</section>
<section id="unless-required-by-applicable-law-or-agreed-to-in-writing-software">
<h1>Unless required by applicable law or agreed to in writing, software<a class="headerlink" href="#unless-required-by-applicable-law-or-agreed-to-in-writing-software" title="Link to this heading"></a></h1>
</section>
<section id="distributed-under-the-license-is-distributed-on-an-as-is-basis">
<h1>distributed under the License is distributed on an “AS IS” BASIS,<a class="headerlink" href="#distributed-under-the-license-is-distributed-on-an-as-is-basis" title="Link to this heading"></a></h1>
</section>
<section id="without-warranties-or-conditions-of-any-kind-either-express-or-implied">
<h1>WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.<a class="headerlink" href="#without-warranties-or-conditions-of-any-kind-either-express-or-implied" title="Link to this heading"></a></h1>
</section>
<section id="see-the-license-for-the-specific-language-governing-permissions-and">
<h1>See the License for the specific language governing permissions and<a class="headerlink" href="#see-the-license-for-the-specific-language-governing-permissions-and" title="Link to this heading"></a></h1>
</section>
<section id="limitations-under-the-license">
<h1>limitations under the License.<a class="headerlink" href="#limitations-under-the-license" title="Link to this heading"></a></h1>
<p>“””
The <code class="docutils literal notranslate"><span class="pre">distro</span></code> package (<code class="docutils literal notranslate"><span class="pre">distro</span></code> stands for Linux Distribution) provides
information about the Linux distribution it runs on, such as a reliable
machine-readable distro ID, or version information.</p>
<p>It is the recommended replacement for Python’s original
:py:func:<code class="docutils literal notranslate"><span class="pre">platform.linux_distribution</span></code> function, but it provides much more
functionality. An alternative implementation became necessary because Python
3.5 deprecated this function, and Python 3.8 removed it altogether. Its
predecessor function :py:func:<code class="docutils literal notranslate"><span class="pre">platform.dist</span></code> was already deprecated since
Python 2.6 and removed in Python 3.8. Still, there are many cases in which
access to OS distribution information is needed. See <code class="docutils literal notranslate"><span class="pre">Python</span> <span class="pre">issue</span> <span class="pre">1322</span> <span class="pre">&lt;https://bugs.python.org/issue1322&gt;</span></code>_ for more information.
“””</p>
<p>import argparse
import json
import logging
import os
import re
import shlex
import subprocess
import sys
import warnings
from typing import (
Any,
Callable,
Dict,
Iterable,
Optional,
Sequence,
TextIO,
Tuple,
Type,
)</p>
<p>try:
from typing import TypedDict
except ImportError:
# Python 3.7
TypedDict = dict</p>
<p><strong>version</strong> = “1.9.0”</p>
<p>class VersionDict(TypedDict):
major: str
minor: str
build_number: str</p>
<p>class InfoDict(TypedDict):
id: str
version: str
version_parts: VersionDict
like: str
codename: str</p>
<p>_UNIXCONFDIR = os.environ.get(“UNIXCONFDIR”, “/etc”)
_UNIXUSRLIBDIR = os.environ.get(“UNIXUSRLIBDIR”, “/usr/lib”)
_OS_RELEASE_BASENAME = “os-release”</p>
<p>#: Translation table for normalizing the “ID” attribute defined in os-release
#: files, for use by the :func:<code class="docutils literal notranslate"><span class="pre">distro.id</span></code> method.
#:
#: * Key: Value as defined in the os-release file, translated to lower case,
#:   with blanks translated to underscores.
#:
#: * Value: Normalized value.
NORMALIZED_OS_ID = {
“ol”: “oracle”,  # Oracle Linux
“opensuse-leap”: “opensuse”,  # Newer versions of OpenSuSE report as opensuse-leap
}</p>
<p>#: Translation table for normalizing the “Distributor ID” attribute returned by
#: the lsb_release command, for use by the :func:<code class="docutils literal notranslate"><span class="pre">distro.id</span></code> method.
#:
#: * Key: Value as returned by the lsb_release command, translated to lower
#:   case, with blanks translated to underscores.
#:
#: * Value: Normalized value.
NORMALIZED_LSB_ID = {
“enterpriseenterpriseas”: “oracle”,  # Oracle Enterprise Linux 4
“enterpriseenterpriseserver”: “oracle”,  # Oracle Linux 5
“redhatenterpriseworkstation”: “rhel”,  # RHEL 6, 7 Workstation
“redhatenterpriseserver”: “rhel”,  # RHEL 6, 7 Server
“redhatenterprisecomputenode”: “rhel”,  # RHEL 6 ComputeNode
}</p>
<p>#: Translation table for normalizing the distro ID derived from the file name
#: of distro release files, for use by the :func:<code class="docutils literal notranslate"><span class="pre">distro.id</span></code> method.
#:
#: * Key: Value as derived from the file name of a distro release file,
#:   translated to lower case, with blanks translated to underscores.
#:
#: * Value: Normalized value.
NORMALIZED_DISTRO_ID = {
“redhat”: “rhel”,  # RHEL 6.x, 7.x
}</p>
</section>
<section id="pattern-for-content-of-distro-release-file-reversed">
<h1>Pattern for content of distro release file (reversed)<a class="headerlink" href="#pattern-for-content-of-distro-release-file-reversed" title="Link to this heading"></a></h1>
<p>_DISTRO_RELEASE_CONTENT_REVERSED_PATTERN = re.compile(
r”(?:<a href="#id6"><span class="problematic" id="id4">[^)]</span></a><em>)(.</em>)()? <em>(?:STL )?([\d.+-a-z]</em>\d) *(?:esaeler *)?(.+)”
)</p>
</section>
<section id="pattern-for-base-file-name-of-distro-release-file">
<h1>Pattern for base file name of distro release file<a class="headerlink" href="#pattern-for-base-file-name-of-distro-release-file" title="Link to this heading"></a></h1>
<p>_DISTRO_RELEASE_BASENAME_PATTERN = re.compile(r”(\w+)<a class="reference internal" href="#release%7Cversion"><span class="xref myst">-_</span></a>$”)</p>
</section>
<section id="base-file-names-to-be-looked-up-for-if-unixconfdir-is-not-readable">
<h1>Base file names to be looked up for if _UNIXCONFDIR is not readable.<a class="headerlink" href="#base-file-names-to-be-looked-up-for-if-unixconfdir-is-not-readable" title="Link to this heading"></a></h1>
<p>_DISTRO_RELEASE_BASENAMES = [
“SuSE-release”,
“altlinux-release”,
“arch-release”,
“base-release”,
“centos-release”,
“fedora-release”,
“gentoo-release”,
“mageia-release”,
“mandrake-release”,
“mandriva-release”,
“mandrivalinux-release”,
“manjaro-release”,
“oracle-release”,
“redhat-release”,
“rocky-release”,
“sl-release”,
“slackware-version”,
]</p>
</section>
<section id="base-file-names-to-be-ignored-when-searching-for-distro-release-file">
<h1>Base file names to be ignored when searching for distro release file<a class="headerlink" href="#base-file-names-to-be-ignored-when-searching-for-distro-release-file" title="Link to this heading"></a></h1>
<p>_DISTRO_RELEASE_IGNORE_BASENAMES = (
“debian_version”,
“lsb-release”,
“oem-release”,
_OS_RELEASE_BASENAME,
“system-release”,
“plesk-release”,
“iredmail-release”,
“board-release”,
“ec2_version”,
)</p>
<p>def linux_distribution(full_distribution_name: bool = True) -&gt; Tuple[str, str, str]:
“””
.. deprecated:: 1.6.0</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    :func:`distro.linux_distribution()` is deprecated. It should only be
    used as a compatibility shim with Python&#39;s
    :py:func:`platform.linux_distribution()`. Please use :func:`distro.id`,
    :func:`distro.version` and :func:`distro.name` instead.

Return information about the current OS distribution as a tuple
``(id_name, version, codename)`` with items as follows:

* ``id_name``:  If *full_distribution_name* is false, the result of
  :func:`distro.id`. Otherwise, the result of :func:`distro.name`.

* ``version``:  The result of :func:`distro.version`.

* ``codename``:  The extra item (usually in parentheses) after the
  os-release version number, or the result of :func:`distro.codename`.

The interface of this function is compatible with the original
:py:func:`platform.linux_distribution` function, supporting a subset of
its parameters.

The data it returns may not exactly be the same, because it uses more data
sources than the original function, and that may lead to different data if
the OS distribution is not consistent across multiple data sources it
provides (there are indeed such distributions ...).

Another reason for differences is the fact that the :func:`distro.id`
method normalizes the distro ID string to a reliable machine-readable value
for a number of popular OS distributions.
&quot;&quot;&quot;
warnings.warn(
    &quot;distro.linux_distribution() is deprecated. It should only be used as a &quot;
    &quot;compatibility shim with Python&#39;s platform.linux_distribution(). Please use &quot;
    &quot;distro.id(), distro.version() and distro.name() instead.&quot;,
    DeprecationWarning,
    stacklevel=2,
)
return _distro.linux_distribution(full_distribution_name)
</pre></div>
</div>
<p>def id() -&gt; str:
“””
Return the distro ID of the current distribution, as a
machine-readable string.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>For a number of OS distributions, the returned distro ID value is
*reliable*, in the sense that it is documented and that it does not change
across releases of the distribution.

This package maintains the following reliable distro ID values:

==============  =========================================
Distro ID       Distribution
==============  =========================================
&quot;ubuntu&quot;        Ubuntu
&quot;debian&quot;        Debian
&quot;rhel&quot;          RedHat Enterprise Linux
&quot;centos&quot;        CentOS
&quot;fedora&quot;        Fedora
&quot;sles&quot;          SUSE Linux Enterprise Server
&quot;opensuse&quot;      openSUSE
&quot;amzn&quot;          Amazon Linux
&quot;arch&quot;          Arch Linux
&quot;buildroot&quot;     Buildroot
&quot;cloudlinux&quot;    CloudLinux OS
&quot;exherbo&quot;       Exherbo Linux
&quot;gentoo&quot;        GenToo Linux
&quot;ibm_powerkvm&quot;  IBM PowerKVM
&quot;kvmibm&quot;        KVM for IBM z Systems
&quot;linuxmint&quot;     Linux Mint
&quot;mageia&quot;        Mageia
&quot;mandriva&quot;      Mandriva Linux
&quot;parallels&quot;     Parallels
&quot;pidora&quot;        Pidora
&quot;raspbian&quot;      Raspbian
&quot;oracle&quot;        Oracle Linux (and Oracle Enterprise Linux)
&quot;scientific&quot;    Scientific Linux
&quot;slackware&quot;     Slackware
&quot;xenserver&quot;     XenServer
&quot;openbsd&quot;       OpenBSD
&quot;netbsd&quot;        NetBSD
&quot;freebsd&quot;       FreeBSD
&quot;midnightbsd&quot;   MidnightBSD
&quot;rocky&quot;         Rocky Linux
&quot;aix&quot;           AIX
&quot;guix&quot;          Guix System
&quot;altlinux&quot;      ALT Linux
==============  =========================================

If you have a need to get distros for reliable IDs added into this set,
or if you find that the :func:`distro.id` function returns a different
distro ID for one of the listed distros, please create an issue in the
`distro issue tracker`_.

**Lookup hierarchy and transformations:**

First, the ID is obtained from the following sources, in the specified
order. The first available and non-empty value is used:

* the value of the &quot;ID&quot; attribute of the os-release file,

* the value of the &quot;Distributor ID&quot; attribute returned by the lsb_release
  command,

* the first part of the file name of the distro release file,

The so determined ID value then passes the following transformations,
before it is returned by this method:

* it is translated to lower case,

* blanks (which should not be there anyway) are translated to underscores,

* a normalization of the ID is performed, based upon
  `normalization tables`_. The purpose of this normalization is to ensure
  that the ID is as reliable as possible, even across incompatible changes
  in the OS distributions. A common reason for an incompatible change is
  the addition of an os-release file, or the addition of the lsb_release
  command, with ID values that differ from what was previously determined
  from the distro release file name.
&quot;&quot;&quot;
return _distro.id()
</pre></div>
</div>
<p>def name(pretty: bool = False) -&gt; str:
“””
Return the name of the current OS distribution, as a human-readable
string.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>If *pretty* is false, the name is returned without version or codename.
(e.g. &quot;CentOS Linux&quot;)

If *pretty* is true, the version and codename are appended.
(e.g. &quot;CentOS Linux 7.1.1503 (Core)&quot;)

**Lookup hierarchy:**

The name is obtained from the following sources, in the specified order.
The first available and non-empty value is used:

* If *pretty* is false:

  - the value of the &quot;NAME&quot; attribute of the os-release file,

  - the value of the &quot;Distributor ID&quot; attribute returned by the lsb_release
    command,

  - the value of the &quot;&lt;name&gt;&quot; field of the distro release file.

* If *pretty* is true:

  - the value of the &quot;PRETTY_NAME&quot; attribute of the os-release file,

  - the value of the &quot;Description&quot; attribute returned by the lsb_release
    command,

  - the value of the &quot;&lt;name&gt;&quot; field of the distro release file, appended
    with the value of the pretty version (&quot;&lt;version_id&gt;&quot; and &quot;&lt;codename&gt;&quot;
    fields) of the distro release file, if available.
&quot;&quot;&quot;
return _distro.name(pretty)
</pre></div>
</div>
<p>def version(pretty: bool = False, best: bool = False) -&gt; str:
“””
Return the version of the current OS distribution, as a human-readable
string.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>If *pretty* is false, the version is returned without codename (e.g.
&quot;7.0&quot;).

If *pretty* is true, the codename in parenthesis is appended, if the
codename is non-empty (e.g. &quot;7.0 (Maipo)&quot;).

Some distributions provide version numbers with different precisions in
the different sources of distribution information. Examining the different
sources in a fixed priority order does not always yield the most precise
version (e.g. for Debian 8.2, or CentOS 7.1).

Some other distributions may not provide this kind of information. In these
cases, an empty string would be returned. This behavior can be observed
with rolling releases distributions (e.g. Arch Linux).

The *best* parameter can be used to control the approach for the returned
version:

If *best* is false, the first non-empty version number in priority order of
the examined sources is returned.

If *best* is true, the most precise version number out of all examined
sources is returned.

**Lookup hierarchy:**

In all cases, the version number is obtained from the following sources.
If *best* is false, this order represents the priority order:

* the value of the &quot;VERSION_ID&quot; attribute of the os-release file,
* the value of the &quot;Release&quot; attribute returned by the lsb_release
  command,
* the version number parsed from the &quot;&lt;version_id&gt;&quot; field of the first line
  of the distro release file,
* the version number parsed from the &quot;PRETTY_NAME&quot; attribute of the
  os-release file, if it follows the format of the distro release files.
* the version number parsed from the &quot;Description&quot; attribute returned by
  the lsb_release command, if it follows the format of the distro release
  files.
&quot;&quot;&quot;
return _distro.version(pretty, best)
</pre></div>
</div>
<p>def version_parts(best: bool = False) -&gt; Tuple[str, str, str]:
“””
Return the version of the current OS distribution as a tuple
<code class="docutils literal notranslate"><span class="pre">(major,</span> <span class="pre">minor,</span> <span class="pre">build_number)</span></code> with items as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* ``major``:  The result of :func:`distro.major_version`.

* ``minor``:  The result of :func:`distro.minor_version`.

* ``build_number``:  The result of :func:`distro.build_number`.

For a description of the *best* parameter, see the :func:`distro.version`
method.
&quot;&quot;&quot;
return _distro.version_parts(best)
</pre></div>
</div>
<p>def major_version(best: bool = False) -&gt; str:
“””
Return the major version of the current OS distribution, as a string,
if provided.
Otherwise, the empty string is returned. The major version is the first
part of the dot-separated version string.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>For a description of the *best* parameter, see the :func:`distro.version`
method.
&quot;&quot;&quot;
return _distro.major_version(best)
</pre></div>
</div>
<p>def minor_version(best: bool = False) -&gt; str:
“””
Return the minor version of the current OS distribution, as a string,
if provided.
Otherwise, the empty string is returned. The minor version is the second
part of the dot-separated version string.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>For a description of the *best* parameter, see the :func:`distro.version`
method.
&quot;&quot;&quot;
return _distro.minor_version(best)
</pre></div>
</div>
<p>def build_number(best: bool = False) -&gt; str:
“””
Return the build number of the current OS distribution, as a string,
if provided.
Otherwise, the empty string is returned. The build number is the third part
of the dot-separated version string.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>For a description of the *best* parameter, see the :func:`distro.version`
method.
&quot;&quot;&quot;
return _distro.build_number(best)
</pre></div>
</div>
<p>def like() -&gt; str:
“””
Return a space-separated list of distro IDs of distributions that are
closely related to the current OS distribution in regards to packaging
and programming interfaces, for example distributions the current
distribution is a derivative from.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>**Lookup hierarchy:**

This information item is only provided by the os-release file.
For details, see the description of the &quot;ID_LIKE&quot; attribute in the
`os-release man page
&lt;http://www.freedesktop.org/software/systemd/man/os-release.html&gt;`_.
&quot;&quot;&quot;
return _distro.like()
</pre></div>
</div>
<p>def codename() -&gt; str:
“””
Return the codename for the release of the current OS distribution,
as a string.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>If the distribution does not have a codename, an empty string is returned.

Note that the returned codename is not always really a codename. For
example, openSUSE returns &quot;x86_64&quot;. This function does not handle such
cases in any special way and just returns the string it finds, if any.

**Lookup hierarchy:**

* the codename within the &quot;VERSION&quot; attribute of the os-release file, if
  provided,

* the value of the &quot;Codename&quot; attribute returned by the lsb_release
  command,

* the value of the &quot;&lt;codename&gt;&quot; field of the distro release file.
&quot;&quot;&quot;
return _distro.codename()
</pre></div>
</div>
<p>def info(pretty: bool = False, best: bool = False) -&gt; InfoDict:
“””
Return certain machine-readable information items about the current OS
distribution in a dictionary, as shown in the following example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>.. sourcecode:: python

    {
        &#39;id&#39;: &#39;rhel&#39;,
        &#39;version&#39;: &#39;7.0&#39;,
        &#39;version_parts&#39;: {
            &#39;major&#39;: &#39;7&#39;,
            &#39;minor&#39;: &#39;0&#39;,
            &#39;build_number&#39;: &#39;&#39;
        },
        &#39;like&#39;: &#39;fedora&#39;,
        &#39;codename&#39;: &#39;Maipo&#39;
    }

The dictionary structure and keys are always the same, regardless of which
information items are available in the underlying data sources. The values
for the various keys are as follows:

* ``id``:  The result of :func:`distro.id`.

* ``version``:  The result of :func:`distro.version`.

* ``version_parts -&gt; major``:  The result of :func:`distro.major_version`.

* ``version_parts -&gt; minor``:  The result of :func:`distro.minor_version`.

* ``version_parts -&gt; build_number``:  The result of
  :func:`distro.build_number`.

* ``like``:  The result of :func:`distro.like`.

* ``codename``:  The result of :func:`distro.codename`.

For a description of the *pretty* and *best* parameters, see the
:func:`distro.version` method.
&quot;&quot;&quot;
return _distro.info(pretty, best)
</pre></div>
</div>
<p>def os_release_info() -&gt; Dict[str, str]:
“””
Return a dictionary containing key-value pairs for the information items
from the os-release file data source of the current OS distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See `os-release file`_ for details about these information items.
&quot;&quot;&quot;
return _distro.os_release_info()
</pre></div>
</div>
<p>def lsb_release_info() -&gt; Dict[str, str]:
“””
Return a dictionary containing key-value pairs for the information items
from the lsb_release command data source of the current OS distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See `lsb_release command output`_ for details about these information
items.
&quot;&quot;&quot;
return _distro.lsb_release_info()
</pre></div>
</div>
<p>def distro_release_info() -&gt; Dict[str, str]:
“””
Return a dictionary containing key-value pairs for the information items
from the distro release file data source of the current OS distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>See `distro release file`_ for details about these information items.
&quot;&quot;&quot;
return _distro.distro_release_info()
</pre></div>
</div>
<p>def uname_info() -&gt; Dict[str, str]:
“””
Return a dictionary containing key-value pairs for the information items
from the distro release file data source of the current OS distribution.
“””
return _distro.uname_info()</p>
<p>def os_release_attr(attribute: str) -&gt; str:
“””
Return a single named information item from the os-release file data source
of the current OS distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters:

* ``attribute`` (string): Key of the information item.

Returns:

* (string): Value of the information item, if the item exists.
  The empty string, if the item does not exist.

See `os-release file`_ for details about these information items.
&quot;&quot;&quot;
return _distro.os_release_attr(attribute)
</pre></div>
</div>
<p>def lsb_release_attr(attribute: str) -&gt; str:
“””
Return a single named information item from the lsb_release command output
data source of the current OS distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters:

* ``attribute`` (string): Key of the information item.

Returns:

* (string): Value of the information item, if the item exists.
  The empty string, if the item does not exist.

See `lsb_release command output`_ for details about these information
items.
&quot;&quot;&quot;
return _distro.lsb_release_attr(attribute)
</pre></div>
</div>
<p>def distro_release_attr(attribute: str) -&gt; str:
“””
Return a single named information item from the distro release file
data source of the current OS distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters:

* ``attribute`` (string): Key of the information item.

Returns:

* (string): Value of the information item, if the item exists.
  The empty string, if the item does not exist.

See `distro release file`_ for details about these information items.
&quot;&quot;&quot;
return _distro.distro_release_attr(attribute)
</pre></div>
</div>
<p>def uname_attr(attribute: str) -&gt; str:
“””
Return a single named information item from the distro release file
data source of the current OS distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters:

* ``attribute`` (string): Key of the information item.

Returns:

* (string): Value of the information item, if the item exists.
            The empty string, if the item does not exist.
&quot;&quot;&quot;
return _distro.uname_attr(attribute)
</pre></div>
</div>
<p>try:
from functools import cached_property
except ImportError:
# Python &lt; 3.8
class cached_property:  # type: ignore
“””A version of &#64;property which caches the value.  On access, it calls the
underlying function and sets the value in <code class="docutils literal notranslate"><span class="pre">__dict__</span></code> so future accesses
will not re-call the property.
“””</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    def __init__(self, f: Callable[[Any], Any]) -&gt; None:
        self._fname = f.__name__
        self._f = f

    def __get__(self, obj: Any, owner: Type[Any]) -&gt; Any:
        assert obj is not None, f&quot;call {self._fname} on an instance&quot;
        ret = obj.__dict__[self._fname] = self._f(obj)
        return ret
</pre></div>
</div>
<p>class LinuxDistribution:
“””
Provides information about a OS distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>This package creates a private module-global instance of this class with
default initialization arguments, that is used by the
`consolidated accessor functions`_ and `single source accessor functions`_.
By using default initialization arguments, that module-global instance
returns data about the current OS distribution (i.e. the distro this
package runs on).

Normally, it is not necessary to create additional instances of this class.
However, in situations where control is needed over the exact data sources
that are used, instances of this class can be created with a specific
distro release file, or a specific os-release file, or without invoking the
lsb_release command.
&quot;&quot;&quot;

def __init__(
    self,
    include_lsb: Optional[bool] = None,
    os_release_file: str = &quot;&quot;,
    distro_release_file: str = &quot;&quot;,
    include_uname: Optional[bool] = None,
    root_dir: Optional[str] = None,
    include_oslevel: Optional[bool] = None,
) -&gt; None:
    &quot;&quot;&quot;
    The initialization method of this class gathers information from the
    available data sources, and stores that in private instance attributes.
    Subsequent access to the information items uses these private instance
    attributes, so that the data sources are read only once.

    Parameters:

    * ``include_lsb`` (bool): Controls whether the
      `lsb_release command output`_ is included as a data source.

      If the lsb_release command is not available in the program execution
      path, the data source for the lsb_release command will be empty.

    * ``os_release_file`` (string): The path name of the
      `os-release file`_ that is to be used as a data source.

      An empty string (the default) will cause the default path name to
      be used (see `os-release file`_ for details).

      If the specified or defaulted os-release file does not exist, the
      data source for the os-release file will be empty.

    * ``distro_release_file`` (string): The path name of the
      `distro release file`_ that is to be used as a data source.

      An empty string (the default) will cause a default search algorithm
      to be used (see `distro release file`_ for details).

      If the specified distro release file does not exist, or if no default
      distro release file can be found, the data source for the distro
      release file will be empty.

    * ``include_uname`` (bool): Controls whether uname command output is
      included as a data source. If the uname command is not available in
      the program execution path the data source for the uname command will
      be empty.

    * ``root_dir`` (string): The absolute path to the root directory to use
      to find distro-related information files. Note that ``include_*``
      parameters must not be enabled in combination with ``root_dir``.

    * ``include_oslevel`` (bool): Controls whether (AIX) oslevel command
      output is included as a data source. If the oslevel command is not
      available in the program execution path the data source will be
      empty.

    Public instance attributes:

    * ``os_release_file`` (string): The path name of the
      `os-release file`_ that is actually used as a data source. The
      empty string if no distro release file is used as a data source.

    * ``distro_release_file`` (string): The path name of the
      `distro release file`_ that is actually used as a data source. The
      empty string if no distro release file is used as a data source.

    * ``include_lsb`` (bool): The result of the ``include_lsb`` parameter.
      This controls whether the lsb information will be loaded.

    * ``include_uname`` (bool): The result of the ``include_uname``
      parameter. This controls whether the uname information will
      be loaded.

    * ``include_oslevel`` (bool): The result of the ``include_oslevel``
      parameter. This controls whether (AIX) oslevel information will be
      loaded.

    * ``root_dir`` (string): The result of the ``root_dir`` parameter.
      The absolute path to the root directory to use to find distro-related
      information files.

    Raises:

    * :py:exc:`ValueError`: Initialization parameters combination is not
       supported.

    * :py:exc:`OSError`: Some I/O issue with an os-release file or distro
      release file.

    * :py:exc:`UnicodeError`: A data source has unexpected characters or
      uses an unexpected encoding.
    &quot;&quot;&quot;
    self.root_dir = root_dir
    self.etc_dir = os.path.join(root_dir, &quot;etc&quot;) if root_dir else _UNIXCONFDIR
    self.usr_lib_dir = (
        os.path.join(root_dir, &quot;usr/lib&quot;) if root_dir else _UNIXUSRLIBDIR
    )

    if os_release_file:
        self.os_release_file = os_release_file
    else:
        etc_dir_os_release_file = os.path.join(self.etc_dir, _OS_RELEASE_BASENAME)
        usr_lib_os_release_file = os.path.join(
            self.usr_lib_dir, _OS_RELEASE_BASENAME
        )

        # NOTE: The idea is to respect order **and** have it set
        #       at all times for API backwards compatibility.
        if os.path.isfile(etc_dir_os_release_file) or not os.path.isfile(
            usr_lib_os_release_file
        ):
            self.os_release_file = etc_dir_os_release_file
        else:
            self.os_release_file = usr_lib_os_release_file

    self.distro_release_file = distro_release_file or &quot;&quot;  # updated later

    is_root_dir_defined = root_dir is not None
    if is_root_dir_defined and (include_lsb or include_uname or include_oslevel):
        raise ValueError(
            &quot;Including subprocess data sources from specific root_dir is disallowed&quot;
            &quot; to prevent false information&quot;
        )
    self.include_lsb = (
        include_lsb if include_lsb is not None else not is_root_dir_defined
    )
    self.include_uname = (
        include_uname if include_uname is not None else not is_root_dir_defined
    )
    self.include_oslevel = (
        include_oslevel if include_oslevel is not None else not is_root_dir_defined
    )

def __repr__(self) -&gt; str:
    &quot;&quot;&quot;Return repr of all info&quot;&quot;&quot;
    return (
        &quot;LinuxDistribution(&quot;
        &quot;os_release_file={self.os_release_file!r}, &quot;
        &quot;distro_release_file={self.distro_release_file!r}, &quot;
        &quot;include_lsb={self.include_lsb!r}, &quot;
        &quot;include_uname={self.include_uname!r}, &quot;
        &quot;include_oslevel={self.include_oslevel!r}, &quot;
        &quot;root_dir={self.root_dir!r}, &quot;
        &quot;_os_release_info={self._os_release_info!r}, &quot;
        &quot;_lsb_release_info={self._lsb_release_info!r}, &quot;
        &quot;_distro_release_info={self._distro_release_info!r}, &quot;
        &quot;_uname_info={self._uname_info!r}, &quot;
        &quot;_oslevel_info={self._oslevel_info!r})&quot;.format(self=self)
    )

def linux_distribution(
    self, full_distribution_name: bool = True
) -&gt; Tuple[str, str, str]:
    &quot;&quot;&quot;
    Return information about the OS distribution that is compatible
    with Python&#39;s :func:`platform.linux_distribution`, supporting a subset
    of its parameters.

    For details, see :func:`distro.linux_distribution`.
    &quot;&quot;&quot;
    return (
        self.name() if full_distribution_name else self.id(),
        self.version(),
        self._os_release_info.get(&quot;release_codename&quot;) or self.codename(),
    )

def id(self) -&gt; str:
    &quot;&quot;&quot;Return the distro ID of the OS distribution, as a string.

    For details, see :func:`distro.id`.
    &quot;&quot;&quot;

    def normalize(distro_id: str, table: Dict[str, str]) -&gt; str:
        distro_id = distro_id.lower().replace(&quot; &quot;, &quot;_&quot;)
        return table.get(distro_id, distro_id)

    distro_id = self.os_release_attr(&quot;id&quot;)
    if distro_id:
        return normalize(distro_id, NORMALIZED_OS_ID)

    distro_id = self.lsb_release_attr(&quot;distributor_id&quot;)
    if distro_id:
        return normalize(distro_id, NORMALIZED_LSB_ID)

    distro_id = self.distro_release_attr(&quot;id&quot;)
    if distro_id:
        return normalize(distro_id, NORMALIZED_DISTRO_ID)

    distro_id = self.uname_attr(&quot;id&quot;)
    if distro_id:
        return normalize(distro_id, NORMALIZED_DISTRO_ID)

    return &quot;&quot;

def name(self, pretty: bool = False) -&gt; str:
    &quot;&quot;&quot;
    Return the name of the OS distribution, as a string.

    For details, see :func:`distro.name`.
    &quot;&quot;&quot;
    name = (
        self.os_release_attr(&quot;name&quot;)
        or self.lsb_release_attr(&quot;distributor_id&quot;)
        or self.distro_release_attr(&quot;name&quot;)
        or self.uname_attr(&quot;name&quot;)
    )
    if pretty:
        name = self.os_release_attr(&quot;pretty_name&quot;) or self.lsb_release_attr(
            &quot;description&quot;
        )
        if not name:
            name = self.distro_release_attr(&quot;name&quot;) or self.uname_attr(&quot;name&quot;)
            version = self.version(pretty=True)
            if version:
                name = f&quot;{name} {version}&quot;
    return name or &quot;&quot;

def version(self, pretty: bool = False, best: bool = False) -&gt; str:
    &quot;&quot;&quot;
    Return the version of the OS distribution, as a string.

    For details, see :func:`distro.version`.
    &quot;&quot;&quot;
    versions = [
        self.os_release_attr(&quot;version_id&quot;),
        self.lsb_release_attr(&quot;release&quot;),
        self.distro_release_attr(&quot;version_id&quot;),
        self._parse_distro_release_content(self.os_release_attr(&quot;pretty_name&quot;)).get(
            &quot;version_id&quot;, &quot;&quot;
        ),
        self._parse_distro_release_content(
            self.lsb_release_attr(&quot;description&quot;)
        ).get(&quot;version_id&quot;, &quot;&quot;),
        self.uname_attr(&quot;release&quot;),
    ]
    if self.uname_attr(&quot;id&quot;).startswith(&quot;aix&quot;):
        # On AIX platforms, prefer oslevel command output.
        versions.insert(0, self.oslevel_info())
    elif self.id() == &quot;debian&quot; or &quot;debian&quot; in self.like().split():
        # On Debian-like, add debian_version file content to candidates list.
        versions.append(self._debian_version)
    version = &quot;&quot;
    if best:
        # This algorithm uses the last version in priority order that has
        # the best precision. If the versions are not in conflict, that
        # does not matter; otherwise, using the last one instead of the
        # first one might be considered a surprise.
        for v in versions:
            if v.count(&quot;.&quot;) &gt; version.count(&quot;.&quot;) or version == &quot;&quot;:
                version = v
    else:
        for v in versions:
            if v != &quot;&quot;:
                version = v
                break
    if pretty and version and self.codename():
        version = f&quot;{version} ({self.codename()})&quot;
    return version

def version_parts(self, best: bool = False) -&gt; Tuple[str, str, str]:
    &quot;&quot;&quot;
    Return the version of the OS distribution, as a tuple of version
    numbers.

    For details, see :func:`distro.version_parts`.
    &quot;&quot;&quot;
    version_str = self.version(best=best)
    if version_str:
        version_regex = re.compile(r&quot;(\d+)\.?(\d+)?\.?(\d+)?&quot;)
        matches = version_regex.match(version_str)
        if matches:
            major, minor, build_number = matches.groups()
            return major, minor or &quot;&quot;, build_number or &quot;&quot;
    return &quot;&quot;, &quot;&quot;, &quot;&quot;

def major_version(self, best: bool = False) -&gt; str:
    &quot;&quot;&quot;
    Return the major version number of the current distribution.

    For details, see :func:`distro.major_version`.
    &quot;&quot;&quot;
    return self.version_parts(best)[0]

def minor_version(self, best: bool = False) -&gt; str:
    &quot;&quot;&quot;
    Return the minor version number of the current distribution.

    For details, see :func:`distro.minor_version`.
    &quot;&quot;&quot;
    return self.version_parts(best)[1]

def build_number(self, best: bool = False) -&gt; str:
    &quot;&quot;&quot;
    Return the build number of the current distribution.

    For details, see :func:`distro.build_number`.
    &quot;&quot;&quot;
    return self.version_parts(best)[2]

def like(self) -&gt; str:
    &quot;&quot;&quot;
    Return the IDs of distributions that are like the OS distribution.

    For details, see :func:`distro.like`.
    &quot;&quot;&quot;
    return self.os_release_attr(&quot;id_like&quot;) or &quot;&quot;

def codename(self) -&gt; str:
    &quot;&quot;&quot;
    Return the codename of the OS distribution.

    For details, see :func:`distro.codename`.
    &quot;&quot;&quot;
    try:
        # Handle os_release specially since distros might purposefully set
        # this to empty string to have no codename
        return self._os_release_info[&quot;codename&quot;]
    except KeyError:
        return (
            self.lsb_release_attr(&quot;codename&quot;)
            or self.distro_release_attr(&quot;codename&quot;)
            or &quot;&quot;
        )

def info(self, pretty: bool = False, best: bool = False) -&gt; InfoDict:
    &quot;&quot;&quot;
    Return certain machine-readable information about the OS
    distribution.

    For details, see :func:`distro.info`.
    &quot;&quot;&quot;
    return InfoDict(
        id=self.id(),
        version=self.version(pretty, best),
        version_parts=VersionDict(
            major=self.major_version(best),
            minor=self.minor_version(best),
            build_number=self.build_number(best),
        ),
        like=self.like(),
        codename=self.codename(),
    )

def os_release_info(self) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Return a dictionary containing key-value pairs for the information
    items from the os-release file data source of the OS distribution.

    For details, see :func:`distro.os_release_info`.
    &quot;&quot;&quot;
    return self._os_release_info

def lsb_release_info(self) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Return a dictionary containing key-value pairs for the information
    items from the lsb_release command data source of the OS
    distribution.

    For details, see :func:`distro.lsb_release_info`.
    &quot;&quot;&quot;
    return self._lsb_release_info

def distro_release_info(self) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Return a dictionary containing key-value pairs for the information
    items from the distro release file data source of the OS
    distribution.

    For details, see :func:`distro.distro_release_info`.
    &quot;&quot;&quot;
    return self._distro_release_info

def uname_info(self) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Return a dictionary containing key-value pairs for the information
    items from the uname command data source of the OS distribution.

    For details, see :func:`distro.uname_info`.
    &quot;&quot;&quot;
    return self._uname_info

def oslevel_info(self) -&gt; str:
    &quot;&quot;&quot;
    Return AIX&#39; oslevel command output.
    &quot;&quot;&quot;
    return self._oslevel_info

def os_release_attr(self, attribute: str) -&gt; str:
    &quot;&quot;&quot;
    Return a single named information item from the os-release file data
    source of the OS distribution.

    For details, see :func:`distro.os_release_attr`.
    &quot;&quot;&quot;
    return self._os_release_info.get(attribute, &quot;&quot;)

def lsb_release_attr(self, attribute: str) -&gt; str:
    &quot;&quot;&quot;
    Return a single named information item from the lsb_release command
    output data source of the OS distribution.

    For details, see :func:`distro.lsb_release_attr`.
    &quot;&quot;&quot;
    return self._lsb_release_info.get(attribute, &quot;&quot;)

def distro_release_attr(self, attribute: str) -&gt; str:
    &quot;&quot;&quot;
    Return a single named information item from the distro release file
    data source of the OS distribution.

    For details, see :func:`distro.distro_release_attr`.
    &quot;&quot;&quot;
    return self._distro_release_info.get(attribute, &quot;&quot;)

def uname_attr(self, attribute: str) -&gt; str:
    &quot;&quot;&quot;
    Return a single named information item from the uname command
    output data source of the OS distribution.

    For details, see :func:`distro.uname_attr`.
    &quot;&quot;&quot;
    return self._uname_info.get(attribute, &quot;&quot;)

@cached_property
def _os_release_info(self) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Get the information items from the specified os-release file.

    Returns:
        A dictionary containing all information items.
    &quot;&quot;&quot;
    if os.path.isfile(self.os_release_file):
        with open(self.os_release_file, encoding=&quot;utf-8&quot;) as release_file:
            return self._parse_os_release_content(release_file)
    return {}

@staticmethod
def _parse_os_release_content(lines: TextIO) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Parse the lines of an os-release file.

    Parameters:

    * lines: Iterable through the lines in the os-release file.
             Each line must be a unicode string or a UTF-8 encoded byte
             string.

    Returns:
        A dictionary containing all information items.
    &quot;&quot;&quot;
    props = {}
    lexer = shlex.shlex(lines, posix=True)
    lexer.whitespace_split = True

    tokens = list(lexer)
    for token in tokens:
        # At this point, all shell-like parsing has been done (i.e.
        # comments processed, quotes and backslash escape sequences
        # processed, multi-line values assembled, trailing newlines
        # stripped, etc.), so the tokens are now either:
        # * variable assignments: var=value
        # * commands or their arguments (not allowed in os-release)
        # Ignore any tokens that are not variable assignments
        if &quot;=&quot; in token:
            k, v = token.split(&quot;=&quot;, 1)
            props[k.lower()] = v

    if &quot;version&quot; in props:
        # extract release codename (if any) from version attribute
        match = re.search(r&quot;\((\D+)\)|,\s*(\D+)&quot;, props[&quot;version&quot;])
        if match:
            release_codename = match.group(1) or match.group(2)
            props[&quot;codename&quot;] = props[&quot;release_codename&quot;] = release_codename

    if &quot;version_codename&quot; in props:
        # os-release added a version_codename field.  Use that in
        # preference to anything else Note that some distros purposefully
        # do not have code names.  They should be setting
        # version_codename=&quot;&quot;
        props[&quot;codename&quot;] = props[&quot;version_codename&quot;]
    elif &quot;ubuntu_codename&quot; in props:
        # Same as above but a non-standard field name used on older Ubuntus
        props[&quot;codename&quot;] = props[&quot;ubuntu_codename&quot;]

    return props

@cached_property
def _lsb_release_info(self) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Get the information items from the lsb_release command output.

    Returns:
        A dictionary containing all information items.
    &quot;&quot;&quot;
    if not self.include_lsb:
        return {}
    try:
        cmd = (&quot;lsb_release&quot;, &quot;-a&quot;)
        stdout = subprocess.check_output(cmd, stderr=subprocess.DEVNULL)
    # Command not found or lsb_release returned error
    except (OSError, subprocess.CalledProcessError):
        return {}
    content = self._to_str(stdout).splitlines()
    return self._parse_lsb_release_content(content)

@staticmethod
def _parse_lsb_release_content(lines: Iterable[str]) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Parse the output of the lsb_release command.

    Parameters:

    * lines: Iterable through the lines of the lsb_release output.
             Each line must be a unicode string or a UTF-8 encoded byte
             string.

    Returns:
        A dictionary containing all information items.
    &quot;&quot;&quot;
    props = {}
    for line in lines:
        kv = line.strip(&quot;\n&quot;).split(&quot;:&quot;, 1)
        if len(kv) != 2:
            # Ignore lines without colon.
            continue
        k, v = kv
        props.update({k.replace(&quot; &quot;, &quot;_&quot;).lower(): v.strip()})
    return props

@cached_property
def _uname_info(self) -&gt; Dict[str, str]:
    if not self.include_uname:
        return {}
    try:
        cmd = (&quot;uname&quot;, &quot;-rs&quot;)
        stdout = subprocess.check_output(cmd, stderr=subprocess.DEVNULL)
    except OSError:
        return {}
    content = self._to_str(stdout).splitlines()
    return self._parse_uname_content(content)

@cached_property
def _oslevel_info(self) -&gt; str:
    if not self.include_oslevel:
        return &quot;&quot;
    try:
        stdout = subprocess.check_output(&quot;oslevel&quot;, stderr=subprocess.DEVNULL)
    except (OSError, subprocess.CalledProcessError):
        return &quot;&quot;
    return self._to_str(stdout).strip()

@cached_property
def _debian_version(self) -&gt; str:
    try:
        with open(
            os.path.join(self.etc_dir, &quot;debian_version&quot;), encoding=&quot;ascii&quot;
        ) as fp:
            return fp.readline().rstrip()
    except FileNotFoundError:
        return &quot;&quot;

@staticmethod
def _parse_uname_content(lines: Sequence[str]) -&gt; Dict[str, str]:
    if not lines:
        return {}
    props = {}
    match = re.search(r&quot;^([^\s]+)\s+([\d\.]+)&quot;, lines[0].strip())
    if match:
        name, version = match.groups()

        # This is to prevent the Linux kernel version from
        # appearing as the &#39;best&#39; version on otherwise
        # identifiable distributions.
        if name == &quot;Linux&quot;:
            return {}
        props[&quot;id&quot;] = name.lower()
        props[&quot;name&quot;] = name
        props[&quot;release&quot;] = version
    return props

@staticmethod
def _to_str(bytestring: bytes) -&gt; str:
    encoding = sys.getfilesystemencoding()
    return bytestring.decode(encoding)

@cached_property
def _distro_release_info(self) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Get the information items from the specified distro release file.

    Returns:
        A dictionary containing all information items.
    &quot;&quot;&quot;
    if self.distro_release_file:
        # If it was specified, we use it and parse what we can, even if
        # its file name or content does not match the expected pattern.
        distro_info = self._parse_distro_release_file(self.distro_release_file)
        basename = os.path.basename(self.distro_release_file)
        # The file name pattern for user-specified distro release files
        # is somewhat more tolerant (compared to when searching for the
        # file), because we want to use what was specified as best as
        # possible.
        match = _DISTRO_RELEASE_BASENAME_PATTERN.match(basename)
    else:
        try:
            basenames = [
                basename
                for basename in os.listdir(self.etc_dir)
                if basename not in _DISTRO_RELEASE_IGNORE_BASENAMES
                and os.path.isfile(os.path.join(self.etc_dir, basename))
            ]
            # We sort for repeatability in cases where there are multiple
            # distro specific files; e.g. CentOS, Oracle, Enterprise all
            # containing `redhat-release` on top of their own.
            basenames.sort()
        except OSError:
            # This may occur when /etc is not readable but we can&#39;t be
            # sure about the *-release files. Check common entries of
            # /etc for information. If they turn out to not be there the
            # error is handled in `_parse_distro_release_file()`.
            basenames = _DISTRO_RELEASE_BASENAMES
        for basename in basenames:
            match = _DISTRO_RELEASE_BASENAME_PATTERN.match(basename)
            if match is None:
                continue
            filepath = os.path.join(self.etc_dir, basename)
            distro_info = self._parse_distro_release_file(filepath)
            # The name is always present if the pattern matches.
            if &quot;name&quot; not in distro_info:
                continue
            self.distro_release_file = filepath
            break
        else:  # the loop didn&#39;t &quot;break&quot;: no candidate.
            return {}

    if match is not None:
        distro_info[&quot;id&quot;] = match.group(1)

    # CloudLinux &lt; 7: manually enrich info with proper id.
    if &quot;cloudlinux&quot; in distro_info.get(&quot;name&quot;, &quot;&quot;).lower():
        distro_info[&quot;id&quot;] = &quot;cloudlinux&quot;

    return distro_info

def _parse_distro_release_file(self, filepath: str) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Parse a distro release file.

    Parameters:

    * filepath: Path name of the distro release file.

    Returns:
        A dictionary containing all information items.
    &quot;&quot;&quot;
    try:
        with open(filepath, encoding=&quot;utf-8&quot;) as fp:
            # Only parse the first line. For instance, on SLES there
            # are multiple lines. We don&#39;t want them...
            return self._parse_distro_release_content(fp.readline())
    except OSError:
        # Ignore not being able to read a specific, seemingly version
        # related file.
        # See https://github.com/python-distro/distro/issues/162
        return {}

@staticmethod
def _parse_distro_release_content(line: str) -&gt; Dict[str, str]:
    &quot;&quot;&quot;
    Parse a line from a distro release file.

    Parameters:
    * line: Line from the distro release file. Must be a unicode string
            or a UTF-8 encoded byte string.

    Returns:
        A dictionary containing all information items.
    &quot;&quot;&quot;
    matches = _DISTRO_RELEASE_CONTENT_REVERSED_PATTERN.match(line.strip()[::-1])
    distro_info = {}
    if matches:
        # regexp ensures non-None
        distro_info[&quot;name&quot;] = matches.group(3)[::-1]
        if matches.group(2):
            distro_info[&quot;version_id&quot;] = matches.group(2)[::-1]
        if matches.group(1):
            distro_info[&quot;codename&quot;] = matches.group(1)[::-1]
    elif line:
        distro_info[&quot;name&quot;] = line.strip()
    return distro_info
</pre></div>
</div>
<p>_distro = LinuxDistribution()</p>
<p>def main() -&gt; None:
logger = logging.getLogger(<strong>name</strong>)
logger.setLevel(logging.DEBUG)
logger.addHandler(logging.StreamHandler(sys.stdout))</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>parser = argparse.ArgumentParser(description=&quot;OS distro info tool&quot;)
parser.add_argument(
    &quot;--json&quot;, &quot;-j&quot;, help=&quot;Output in machine readable format&quot;, action=&quot;store_true&quot;
)

parser.add_argument(
    &quot;--root-dir&quot;,
    &quot;-r&quot;,
    type=str,
    dest=&quot;root_dir&quot;,
    help=&quot;Path to the root filesystem directory (defaults to /)&quot;,
)

args = parser.parse_args()

if args.root_dir:
    dist = LinuxDistribution(
        include_lsb=False,
        include_uname=False,
        include_oslevel=False,
        root_dir=args.root_dir,
    )
else:
    dist = _distro

if args.json:
    logger.info(json.dumps(dist.info(), indent=4, sort_keys=True))
else:
    logger.info(&quot;Name: %s&quot;, dist.name(pretty=True))
    distribution_version = dist.version(pretty=True)
    logger.info(&quot;Version: %s&quot;, distribution_version)
    distribution_codename = dist.codename()
    logger.info(&quot;Codename: %s&quot;, distribution_codename)
</pre></div>
</div>
<p>if <strong>name</strong> == “<strong>main</strong>”:
main()</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Adam Worsnip.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>