

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Retrogue 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/custom.css?v=a6a68382" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/fonts.css?v=5583d106" />

  
      <script src="../../../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../../index.html" class="icon icon-home">
            Retrogue
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../index.html">Retrogue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../../_sources/.venv/lib/python3.14/site-packages/pip/_internal/distributions/sdist.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>from <strong>future</strong> import annotations</p>
<p>import logging
from collections.abc import Iterable
from typing import TYPE_CHECKING</p>
<p>from pip._internal.build_env import BuildEnvironment
from pip._internal.distributions.base import AbstractDistribution
from pip._internal.exceptions import InstallationError
from pip._internal.metadata import BaseDistribution
from pip._internal.utils.subprocess import runner_with_spinner_message</p>
<p>if TYPE_CHECKING:
from pip._internal.build_env import BuildEnvironmentInstaller</p>
<p>logger = logging.getLogger(<strong>name</strong>)</p>
<p>class SourceDistribution(AbstractDistribution):
“””Represents a source distribution.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>The preparation step for these needs metadata for the packages to be
generated.
&quot;&quot;&quot;

@property
def build_tracker_id(self) -&gt; str | None:
    &quot;&quot;&quot;Identify this requirement uniquely by its link.&quot;&quot;&quot;
    assert self.req.link
    return self.req.link.url_without_fragment

def get_metadata_distribution(self) -&gt; BaseDistribution:
    return self.req.get_dist()

def prepare_distribution_metadata(
    self,
    build_env_installer: BuildEnvironmentInstaller,
    build_isolation: bool,
    check_build_deps: bool,
) -&gt; None:
    # Load pyproject.toml
    self.req.load_pyproject_toml()

    # Set up the build isolation, if this requirement should be isolated
    if build_isolation:
        # Setup an isolated environment and install the build backend static
        # requirements in it.
        self._prepare_build_backend(build_env_installer)
        # Check that the build backend supports PEP 660. This cannot be done
        # earlier because we need to setup the build backend to verify it
        # supports build_editable, nor can it be done later, because we want
        # to avoid installing build requirements needlessly.
        self.req.editable_sanity_check()
        # Install the dynamic build requirements.
        self._install_build_reqs(build_env_installer)
    else:
        # When not using build isolation, we still need to check that
        # the build backend supports PEP 660.
        self.req.editable_sanity_check()
    # Check if the current environment provides build dependencies
    if check_build_deps:
        pyproject_requires = self.req.pyproject_requires
        assert pyproject_requires is not None
        conflicting, missing = self.req.build_env.check_requirements(
            pyproject_requires
        )
        if conflicting:
            self._raise_conflicts(&quot;the backend dependencies&quot;, conflicting)
        if missing:
            self._raise_missing_reqs(missing)
    self.req.prepare_metadata()

def _prepare_build_backend(
    self, build_env_installer: BuildEnvironmentInstaller
) -&gt; None:
    # Isolate in a BuildEnvironment and install the build-time
    # requirements.
    pyproject_requires = self.req.pyproject_requires
    assert pyproject_requires is not None

    self.req.build_env = BuildEnvironment(build_env_installer)
    self.req.build_env.install_requirements(
        pyproject_requires, &quot;overlay&quot;, kind=&quot;build dependencies&quot;, for_req=self.req
    )
    conflicting, missing = self.req.build_env.check_requirements(
        self.req.requirements_to_check
    )
    if conflicting:
        self._raise_conflicts(&quot;PEP 517/518 supported requirements&quot;, conflicting)
    if missing:
        logger.warning(
            &quot;Missing build requirements in pyproject.toml for %s.&quot;,
            self.req,
        )
        logger.warning(
            &quot;The project does not specify a build backend, and &quot;
            &quot;pip cannot fall back to setuptools without %s.&quot;,
            &quot; and &quot;.join(map(repr, sorted(missing))),
        )

def _get_build_requires_wheel(self) -&gt; Iterable[str]:
    with self.req.build_env:
        runner = runner_with_spinner_message(&quot;Getting requirements to build wheel&quot;)
        backend = self.req.pep517_backend
        assert backend is not None
        with backend.subprocess_runner(runner):
            return backend.get_requires_for_build_wheel()

def _get_build_requires_editable(self) -&gt; Iterable[str]:
    with self.req.build_env:
        runner = runner_with_spinner_message(
            &quot;Getting requirements to build editable&quot;
        )
        backend = self.req.pep517_backend
        assert backend is not None
        with backend.subprocess_runner(runner):
            return backend.get_requires_for_build_editable()

def _install_build_reqs(
    self, build_env_installer: BuildEnvironmentInstaller
) -&gt; None:
    # Install any extra build dependencies that the backend requests.
    # This must be done in a second pass, as the pyproject.toml
    # dependencies must be installed before we can call the backend.
    if (
        self.req.editable
        and self.req.permit_editable_wheels
        and self.req.supports_pyproject_editable
    ):
        build_reqs = self._get_build_requires_editable()
    else:
        build_reqs = self._get_build_requires_wheel()
    conflicting, missing = self.req.build_env.check_requirements(build_reqs)
    if conflicting:
        self._raise_conflicts(&quot;the backend dependencies&quot;, conflicting)
    self.req.build_env.install_requirements(
        missing, &quot;normal&quot;, kind=&quot;backend dependencies&quot;, for_req=self.req
    )

def _raise_conflicts(
    self, conflicting_with: str, conflicting_reqs: set[tuple[str, str]]
) -&gt; None:
    format_string = (
        &quot;Some build dependencies for {requirement} &quot;
        &quot;conflict with {conflicting_with}: {description}.&quot;
    )
    error_message = format_string.format(
        requirement=self.req,
        conflicting_with=conflicting_with,
        description=&quot;, &quot;.join(
            f&quot;{installed} is incompatible with {wanted}&quot;
            for installed, wanted in sorted(conflicting_reqs)
        ),
    )
    raise InstallationError(error_message)

def _raise_missing_reqs(self, missing: set[str]) -&gt; None:
    format_string = (
        &quot;Some build dependencies for {requirement} are missing: {missing}.&quot;
    )
    error_message = format_string.format(
        requirement=self.req, missing=&quot;, &quot;.join(map(repr, sorted(missing)))
    )
    raise InstallationError(error_message)
</pre></div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Adam Worsnip.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>