

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; Retrogue 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/custom.css?v=a6a68382" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../_static/fonts.css?v=5583d106" />

  
      <script src="../../../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../../index.html" class="icon icon-home">
            Retrogue
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../index.html">Retrogue</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../../_sources/.venv/lib/python3.14/site-packages/pip/_vendor/rich/logging.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>import logging
from datetime import datetime
from logging import Handler, LogRecord
from pathlib import Path
from types import ModuleType
from typing import ClassVar, Iterable, List, Optional, Type, Union</p>
<p>from pip._vendor.rich._null_file import NullFile</p>
<p>from . import get_console
from ._log_render import FormatTimeCallable, LogRender
from .console import Console, ConsoleRenderable
from .highlighter import Highlighter, ReprHighlighter
from .text import Text
from .traceback import Traceback</p>
<p>class RichHandler(Handler):
“””A logging handler that renders output with Rich. The time / level / message and file are displayed in columns.
The level is color coded, and the message is syntax highlighted.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Note:
    Be careful when enabling console markup in log messages if you have configured logging for libraries not
    under your control. If a dependency writes messages containing square brackets, it may not produce the intended output.

Args:
    level (Union[int, str], optional): Log level. Defaults to logging.NOTSET.
    console (:class:`~rich.console.Console`, optional): Optional console instance to write logs.
        Default will use a global console instance writing to stdout.
    show_time (bool, optional): Show a column for the time. Defaults to True.
    omit_repeated_times (bool, optional): Omit repetition of the same time. Defaults to True.
    show_level (bool, optional): Show a column for the level. Defaults to True.
    show_path (bool, optional): Show the path to the original log call. Defaults to True.
    enable_link_path (bool, optional): Enable terminal link of path column to file. Defaults to True.
    highlighter (Highlighter, optional): Highlighter to style log messages, or None to use ReprHighlighter. Defaults to None.
    markup (bool, optional): Enable console markup in log messages. Defaults to False.
    rich_tracebacks (bool, optional): Enable rich tracebacks with syntax highlighting and formatting. Defaults to False.
    tracebacks_width (Optional[int], optional): Number of characters used to render tracebacks, or None for full width. Defaults to None.
    tracebacks_code_width (int, optional): Number of code characters used to render tracebacks, or None for full width. Defaults to 88.
    tracebacks_extra_lines (int, optional): Additional lines of code to render tracebacks, or None for full width. Defaults to None.
    tracebacks_theme (str, optional): Override pygments theme used in traceback.
    tracebacks_word_wrap (bool, optional): Enable word wrapping of long tracebacks lines. Defaults to True.
    tracebacks_show_locals (bool, optional): Enable display of locals in tracebacks. Defaults to False.
    tracebacks_suppress (Sequence[Union[str, ModuleType]]): Optional sequence of modules or paths to exclude from traceback.
    tracebacks_max_frames (int, optional): Optional maximum number of frames returned by traceback.
    locals_max_length (int, optional): Maximum length of containers before abbreviating, or None for no abbreviation.
        Defaults to 10.
    locals_max_string (int, optional): Maximum length of string before truncating, or None to disable. Defaults to 80.
    log_time_format (Union[str, TimeFormatterCallable], optional): If ``log_time`` is enabled, either string for strftime or callable that formats the time. Defaults to &quot;[%x %X] &quot;.
    keywords (List[str], optional): List of words to highlight instead of ``RichHandler.KEYWORDS``.
&quot;&quot;&quot;

KEYWORDS: ClassVar[Optional[List[str]]] = [
    &quot;GET&quot;,
    &quot;POST&quot;,
    &quot;HEAD&quot;,
    &quot;PUT&quot;,
    &quot;DELETE&quot;,
    &quot;OPTIONS&quot;,
    &quot;TRACE&quot;,
    &quot;PATCH&quot;,
]
HIGHLIGHTER_CLASS: ClassVar[Type[Highlighter]] = ReprHighlighter

def __init__(
    self,
    level: Union[int, str] = logging.NOTSET,
    console: Optional[Console] = None,
    *,
    show_time: bool = True,
    omit_repeated_times: bool = True,
    show_level: bool = True,
    show_path: bool = True,
    enable_link_path: bool = True,
    highlighter: Optional[Highlighter] = None,
    markup: bool = False,
    rich_tracebacks: bool = False,
    tracebacks_width: Optional[int] = None,
    tracebacks_code_width: Optional[int] = 88,
    tracebacks_extra_lines: int = 3,
    tracebacks_theme: Optional[str] = None,
    tracebacks_word_wrap: bool = True,
    tracebacks_show_locals: bool = False,
    tracebacks_suppress: Iterable[Union[str, ModuleType]] = (),
    tracebacks_max_frames: int = 100,
    locals_max_length: int = 10,
    locals_max_string: int = 80,
    log_time_format: Union[str, FormatTimeCallable] = &quot;[%x %X]&quot;,
    keywords: Optional[List[str]] = None,
) -&gt; None:
    super().__init__(level=level)
    self.console = console or get_console()
    self.highlighter = highlighter or self.HIGHLIGHTER_CLASS()
    self._log_render = LogRender(
        show_time=show_time,
        show_level=show_level,
        show_path=show_path,
        time_format=log_time_format,
        omit_repeated_times=omit_repeated_times,
        level_width=None,
    )
    self.enable_link_path = enable_link_path
    self.markup = markup
    self.rich_tracebacks = rich_tracebacks
    self.tracebacks_width = tracebacks_width
    self.tracebacks_extra_lines = tracebacks_extra_lines
    self.tracebacks_theme = tracebacks_theme
    self.tracebacks_word_wrap = tracebacks_word_wrap
    self.tracebacks_show_locals = tracebacks_show_locals
    self.tracebacks_suppress = tracebacks_suppress
    self.tracebacks_max_frames = tracebacks_max_frames
    self.tracebacks_code_width = tracebacks_code_width
    self.locals_max_length = locals_max_length
    self.locals_max_string = locals_max_string
    self.keywords = keywords

def get_level_text(self, record: LogRecord) -&gt; Text:
    &quot;&quot;&quot;Get the level name from the record.

    Args:
        record (LogRecord): LogRecord instance.

    Returns:
        Text: A tuple of the style and level name.
    &quot;&quot;&quot;
    level_name = record.levelname
    level_text = Text.styled(
        level_name.ljust(8), f&quot;logging.level.{level_name.lower()}&quot;
    )
    return level_text

def emit(self, record: LogRecord) -&gt; None:
    &quot;&quot;&quot;Invoked by logging.&quot;&quot;&quot;
    message = self.format(record)
    traceback = None
    if (
        self.rich_tracebacks
        and record.exc_info
        and record.exc_info != (None, None, None)
    ):
        exc_type, exc_value, exc_traceback = record.exc_info
        assert exc_type is not None
        assert exc_value is not None
        traceback = Traceback.from_exception(
            exc_type,
            exc_value,
            exc_traceback,
            width=self.tracebacks_width,
            code_width=self.tracebacks_code_width,
            extra_lines=self.tracebacks_extra_lines,
            theme=self.tracebacks_theme,
            word_wrap=self.tracebacks_word_wrap,
            show_locals=self.tracebacks_show_locals,
            locals_max_length=self.locals_max_length,
            locals_max_string=self.locals_max_string,
            suppress=self.tracebacks_suppress,
            max_frames=self.tracebacks_max_frames,
        )
        message = record.getMessage()
        if self.formatter:
            record.message = record.getMessage()
            formatter = self.formatter
            if hasattr(formatter, &quot;usesTime&quot;) and formatter.usesTime():
                record.asctime = formatter.formatTime(record, formatter.datefmt)
            message = formatter.formatMessage(record)

    message_renderable = self.render_message(record, message)
    log_renderable = self.render(
        record=record, traceback=traceback, message_renderable=message_renderable
    )
    if isinstance(self.console.file, NullFile):
        # Handles pythonw, where stdout/stderr are null, and we return NullFile
        # instance from Console.file. In this case, we still want to make a log record
        # even though we won&#39;t be writing anything to a file.
        self.handleError(record)
    else:
        try:
            self.console.print(log_renderable)
        except Exception:
            self.handleError(record)

def render_message(self, record: LogRecord, message: str) -&gt; &quot;ConsoleRenderable&quot;:
    &quot;&quot;&quot;Render message text in to Text.

    Args:
        record (LogRecord): logging Record.
        message (str): String containing log message.

    Returns:
        ConsoleRenderable: Renderable to display log message.
    &quot;&quot;&quot;
    use_markup = getattr(record, &quot;markup&quot;, self.markup)
    message_text = Text.from_markup(message) if use_markup else Text(message)

    highlighter = getattr(record, &quot;highlighter&quot;, self.highlighter)
    if highlighter:
        message_text = highlighter(message_text)

    if self.keywords is None:
        self.keywords = self.KEYWORDS

    if self.keywords:
        message_text.highlight_words(self.keywords, &quot;logging.keyword&quot;)

    return message_text

def render(
    self,
    *,
    record: LogRecord,
    traceback: Optional[Traceback],
    message_renderable: &quot;ConsoleRenderable&quot;,
) -&gt; &quot;ConsoleRenderable&quot;:
    &quot;&quot;&quot;Render log for display.

    Args:
        record (LogRecord): logging Record.
        traceback (Optional[Traceback]): Traceback instance or None for no Traceback.
        message_renderable (ConsoleRenderable): Renderable (typically Text) containing log message contents.

    Returns:
        ConsoleRenderable: Renderable to display log.
    &quot;&quot;&quot;
    path = Path(record.pathname).name
    level = self.get_level_text(record)
    time_format = None if self.formatter is None else self.formatter.datefmt
    log_time = datetime.fromtimestamp(record.created)

    log_renderable = self._log_render(
        self.console,
        [message_renderable] if not traceback else [message_renderable, traceback],
        log_time=log_time,
        time_format=time_format,
        level=level,
        path=path,
        line_no=record.lineno,
        link_path=record.pathname if self.enable_link_path else None,
    )
    return log_renderable
</pre></div>
</div>
<p>if <strong>name</strong> == “<strong>main</strong>”:  # pragma: no cover
from time import sleep</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>FORMAT = &quot;%(message)s&quot;
# FORMAT = &quot;%(asctime)-15s - %(levelname)s - %(message)s&quot;
logging.basicConfig(
    level=&quot;NOTSET&quot;,
    format=FORMAT,
    datefmt=&quot;[%X]&quot;,
    handlers=[RichHandler(rich_tracebacks=True, tracebacks_show_locals=True)],
)
log = logging.getLogger(&quot;rich&quot;)

log.info(&quot;Server starting...&quot;)
log.info(&quot;Listening on http://127.0.0.1:8080&quot;)
sleep(1)

log.info(&quot;GET /index.html 200 1298&quot;)
log.info(&quot;GET /imgs/backgrounds/back1.jpg 200 54386&quot;)
log.info(&quot;GET /css/styles.css 200 54386&quot;)
log.warning(&quot;GET /favicon.ico 404 242&quot;)
sleep(1)

log.debug(
    &quot;JSONRPC request\n--&gt; %r\n&lt;-- %r&quot;,
    {
        &quot;version&quot;: &quot;1.1&quot;,
        &quot;method&quot;: &quot;confirmFruitPurchase&quot;,
        &quot;params&quot;: [[&quot;apple&quot;, &quot;orange&quot;, &quot;mangoes&quot;, &quot;pomelo&quot;], 1.123],
        &quot;id&quot;: &quot;194521489&quot;,
    },
    {&quot;version&quot;: &quot;1.1&quot;, &quot;result&quot;: True, &quot;error&quot;: None, &quot;id&quot;: &quot;194521489&quot;},
)
log.debug(
    &quot;Loading configuration file /adasd/asdasd/qeqwe/qwrqwrqwr/sdgsdgsdg/werwerwer/dfgerert/ertertert/ertetert/werwerwer&quot;
)
log.error(&quot;Unable to find &#39;pomelo&#39; in database!&quot;)
log.info(&quot;POST /jsonrpc/ 200 65532&quot;)
log.info(&quot;POST /admin/ 401 42234&quot;)
log.warning(&quot;password was rejected for admin site.&quot;)

def divide() -&gt; None:
    number = 1
    divisor = 0
    foos = [&quot;foo&quot;] * 100
    log.debug(&quot;in divide&quot;)
    try:
        number / divisor
    except:
        log.exception(&quot;An error of some kind occurred!&quot;)

divide()
sleep(1)
log.critical(&quot;Out of memory!&quot;)
log.info(&quot;Server exited with code=-1&quot;)
log.info(&quot;[bold]EXITING...[/bold]&quot;, extra=dict(markup=True))
</pre></div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Adam Worsnip.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>